[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar ECMAScript = Package.ecmascript.ECMAScript;\nvar _ = Package.underscore._;\nvar meteorInstall = Package.modules.meteorInstall;\nvar meteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nvar Promise = Package.promise.Promise;\nvar Symbol = Package['ecmascript-runtime-server'].Symbol;\nvar Map = Package['ecmascript-runtime-server'].Map;\nvar Set = Package['ecmascript-runtime-server'].Set;\n\n/* Package-scope variables */\nvar Boilerplate;\n\nvar require = meteorInstall({\"node_modules\":{\"meteor\":{\"boilerplate-generator\":{\"generator.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/boilerplate-generator/generator.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nvar _extends2 = require(\"babel-runtime/helpers/extends\");                                                              //\n                                                                                                                       //\nvar _extends3 = _interopRequireDefault(_extends2);                                                                     //\n                                                                                                                       //\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");                                                //\n                                                                                                                       //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                       //\n                                                                                                                       //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }                      //\n                                                                                                                       //\nmodule.export({                                                                                                        // 1\n  Boilerplate: function () {                                                                                           // 1\n    return Boilerplate;                                                                                                // 1\n  }                                                                                                                    // 1\n});                                                                                                                    // 1\nvar readFile = void 0;                                                                                                 // 1\nmodule.watch(require(\"fs\"), {                                                                                          // 1\n  readFile: function (v) {                                                                                             // 1\n    readFile = v;                                                                                                      // 1\n  }                                                                                                                    // 1\n}, 0);                                                                                                                 // 1\nvar WebBrowserTemplate = void 0;                                                                                       // 1\nmodule.watch(require(\"./template-web.browser\"), {                                                                      // 1\n  \"default\": function (v) {                                                                                            // 1\n    WebBrowserTemplate = v;                                                                                            // 1\n  }                                                                                                                    // 1\n}, 1);                                                                                                                 // 1\nvar WebCordovaTemplate = void 0;                                                                                       // 1\nmodule.watch(require(\"./template-web.cordova\"), {                                                                      // 1\n  \"default\": function (v) {                                                                                            // 1\n    WebCordovaTemplate = v;                                                                                            // 1\n  }                                                                                                                    // 1\n}, 2);                                                                                                                 // 1\n                                                                                                                       //\n// Copied from webapp_server                                                                                           // 6\nvar readUtf8FileSync = function (filename) {                                                                           // 7\n  return Meteor.wrapAsync(readFile)(filename, 'utf8');                                                                 // 7\n};                                                                                                                     // 7\n                                                                                                                       //\nvar Boilerplate = function () {                                                                                        //\n  function Boilerplate(arch, manifest) {                                                                               // 10\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};                              // 10\n    (0, _classCallCheck3.default)(this, Boilerplate);                                                                  // 10\n    this.template = _getTemplate(arch);                                                                                // 11\n    this.baseData = null;                                                                                              // 12\n                                                                                                                       //\n    this._generateBoilerplateFromManifest(manifest, options);                                                          // 14\n  } // The 'extraData' argument can be used to extend 'self.baseData'. Its                                             // 18\n  // purpose is to allow you to specify data that you might not know at                                                // 21\n  // the time that you construct the Boilerplate object. (e.g. it is used                                              // 22\n  // by 'webapp' to specify data that is only known at request-time).                                                  // 23\n                                                                                                                       //\n                                                                                                                       //\n  Boilerplate.prototype.toHTML = function () {                                                                         //\n    function toHTML(extraData) {                                                                                       //\n      if (!this.baseData || !this.template) {                                                                          // 25\n        throw new Error('Boilerplate did not instantiate correctly.');                                                 // 26\n      }                                                                                                                // 27\n                                                                                                                       //\n      return \"<!DOCTYPE html>\\n\" + this.template((0, _extends3.default)({}, this.baseData, extraData));                // 29\n    }                                                                                                                  // 31\n                                                                                                                       //\n    return toHTML;                                                                                                     //\n  }(); // XXX Exported to allow client-side only changes to rebuild the boilerplate                                    //\n  // without requiring a full server restart.                                                                          // 34\n  // Produces an HTML string with given manifest and boilerplateSource.                                                // 35\n  // Optionally takes urlMapper in case urls from manifest need to be prefixed                                         // 36\n  // or rewritten.                                                                                                     // 37\n  // Optionally takes pathMapper for resolving relative file system paths.                                             // 38\n  // Optionally allows to override fields of the data context.                                                         // 39\n                                                                                                                       //\n                                                                                                                       //\n  Boilerplate.prototype._generateBoilerplateFromManifest = function () {                                               //\n    function _generateBoilerplateFromManifest(manifest) {                                                              //\n      var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},                               // 45\n          _ref$urlMapper = _ref.urlMapper,                                                                             // 45\n          urlMapper = _ref$urlMapper === undefined ? _.identity : _ref$urlMapper,                                      // 45\n          _ref$pathMapper = _ref.pathMapper,                                                                           // 45\n          pathMapper = _ref$pathMapper === undefined ? _.identity : _ref$pathMapper,                                   // 45\n          baseDataExtension = _ref.baseDataExtension,                                                                  // 45\n          inline = _ref.inline;                                                                                        // 45\n                                                                                                                       //\n      var boilerplateBaseData = (0, _extends3.default)({                                                               // 47\n        css: [],                                                                                                       // 48\n        js: [],                                                                                                        // 49\n        head: '',                                                                                                      // 50\n        body: '',                                                                                                      // 51\n        meteorManifest: JSON.stringify(manifest)                                                                       // 52\n      }, baseDataExtension);                                                                                           // 47\n                                                                                                                       //\n      _.each(manifest, function (item) {                                                                               // 56\n        var urlPath = urlMapper(item.url);                                                                             // 57\n        var itemObj = {                                                                                                // 58\n          url: urlPath                                                                                                 // 58\n        };                                                                                                             // 58\n                                                                                                                       //\n        if (inline) {                                                                                                  // 60\n          itemObj.scriptContent = readUtf8FileSync(pathMapper(item.path));                                             // 61\n          itemObj.inline = true;                                                                                       // 63\n        }                                                                                                              // 64\n                                                                                                                       //\n        if (item.type === 'css' && item.where === 'client') {                                                          // 66\n          boilerplateBaseData.css.push(itemObj);                                                                       // 67\n        }                                                                                                              // 68\n                                                                                                                       //\n        if (item.type === 'js' && item.where === 'client' && // Dynamic JS modules should not be loaded eagerly in the\n        // initial HTML of the app.                                                                                    // 72\n        !item.path.startsWith('dynamic/')) {                                                                           // 73\n          boilerplateBaseData.js.push(itemObj);                                                                        // 74\n        }                                                                                                              // 75\n                                                                                                                       //\n        if (item.type === 'head') {                                                                                    // 77\n          boilerplateBaseData.head = readUtf8FileSync(pathMapper(item.path));                                          // 78\n        }                                                                                                              // 80\n                                                                                                                       //\n        if (item.type === 'body') {                                                                                    // 82\n          boilerplateBaseData.body = readUtf8FileSync(pathMapper(item.path));                                          // 83\n        }                                                                                                              // 85\n      });                                                                                                              // 86\n                                                                                                                       //\n      this.baseData = boilerplateBaseData;                                                                             // 88\n    }                                                                                                                  // 89\n                                                                                                                       //\n    return _generateBoilerplateFromManifest;                                                                           //\n  }();                                                                                                                 //\n                                                                                                                       //\n  return Boilerplate;                                                                                                  //\n}();                                                                                                                   //\n                                                                                                                       //\n; // Returns a template function that, when called, produces the boilerplate                                           // 90\n// html as a string.                                                                                                   // 93\n                                                                                                                       //\nvar _getTemplate = function (arch) {                                                                                   // 94\n  if (arch === 'web.browser') {                                                                                        // 95\n    return WebBrowserTemplate;                                                                                         // 96\n  } else if (arch === 'web.cordova') {                                                                                 // 97\n    return WebCordovaTemplate;                                                                                         // 98\n  } else {                                                                                                             // 99\n    throw new Error('Unsupported arch: ' + arch);                                                                      // 100\n  }                                                                                                                    // 101\n};                                                                                                                     // 102\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template-web.browser.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/boilerplate-generator/template-web.browser.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.exportDefault(function (_ref) {                                                                                 // 1\n  var meteorRuntimeConfig = _ref.meteorRuntimeConfig,                                                                  // 16\n      rootUrlPathPrefix = _ref.rootUrlPathPrefix,                                                                      // 16\n      inlineScriptsAllowed = _ref.inlineScriptsAllowed,                                                                // 16\n      css = _ref.css,                                                                                                  // 16\n      js = _ref.js,                                                                                                    // 16\n      additionalStaticJs = _ref.additionalStaticJs,                                                                    // 16\n      htmlAttributes = _ref.htmlAttributes,                                                                            // 16\n      bundledJsCssUrlRewriteHook = _ref.bundledJsCssUrlRewriteHook,                                                    // 16\n      head = _ref.head,                                                                                                // 16\n      body = _ref.body,                                                                                                // 16\n      dynamicHead = _ref.dynamicHead,                                                                                  // 16\n      dynamicBody = _ref.dynamicBody;                                                                                  // 16\n  return [].concat(['<html' + _.map(htmlAttributes, function (value, key) {                                            // 17\n    return _.template(' <%= attrName %>=\"<%- attrValue %>\"')({                                                         // 19\n      attrName: key,                                                                                                   // 21\n      attrValue: value                                                                                                 // 22\n    });                                                                                                                // 20\n  }).join('') + '>', '<head>'], _.map(css, function (_ref2) {                                                          // 19\n    var url = _ref2.url;                                                                                               // 28\n    return _.template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\">')({         // 28\n      href: bundledJsCssUrlRewriteHook(url)                                                                            // 30\n    });                                                                                                                // 29\n  }), [head, dynamicHead, '</head>', '<body>', body, dynamicBody, '', inlineScriptsAllowed ? _.template('  <script type=\"text/javascript\">__meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>))</script>')({\n    conf: meteorRuntimeConfig                                                                                          // 44\n  }) : _.template('  <script type=\"text/javascript\" src=\"<%- src %>/meteor_runtime_config.js\"></script>')({            // 43\n    src: rootUrlPathPrefix                                                                                             // 47\n  }), ''], _.map(js, function (_ref3) {                                                                                // 46\n    var url = _ref3.url;                                                                                               // 53\n    return _.template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({                                 // 53\n      src: bundledJsCssUrlRewriteHook(url)                                                                             // 55\n    });                                                                                                                // 54\n  }), _.map(additionalStaticJs, function (_ref4) {                                                                     // 53\n    var contents = _ref4.contents,                                                                                     // 59\n        pathname = _ref4.pathname;                                                                                     // 59\n    return inlineScriptsAllowed ? _.template('  <script><%= contents %></script>')({                                   // 59\n      contents: contents                                                                                               // 62\n    }) : _.template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({                                   // 61\n      src: rootUrlPathPrefix + pathname                                                                                // 65\n    });                                                                                                                // 64\n  }), ['', '', '</body>', '</html>']).join('\\n');                                                                      // 59\n});                                                                                                                    // 75\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template-web.cordova.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/boilerplate-generator/template-web.cordova.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.exportDefault(function (_ref) {                                                                                 // 1\n  var meteorRuntimeConfig = _ref.meteorRuntimeConfig,                                                                  // 16\n      rootUrlPathPrefix = _ref.rootUrlPathPrefix,                                                                      // 16\n      inlineScriptsAllowed = _ref.inlineScriptsAllowed,                                                                // 16\n      css = _ref.css,                                                                                                  // 16\n      js = _ref.js,                                                                                                    // 16\n      additionalStaticJs = _ref.additionalStaticJs,                                                                    // 16\n      htmlAttributes = _ref.htmlAttributes,                                                                            // 16\n      bundledJsCssUrlRewriteHook = _ref.bundledJsCssUrlRewriteHook,                                                    // 16\n      head = _ref.head,                                                                                                // 16\n      body = _ref.body,                                                                                                // 16\n      dynamicHead = _ref.dynamicHead,                                                                                  // 16\n      dynamicBody = _ref.dynamicBody;                                                                                  // 16\n  return [].concat(['<html>', '<head>', '  <meta charset=\"utf-8\">', '  <meta name=\"format-detection\" content=\"telephone=no\">', '  <meta name=\"viewport\" content=\"user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height\">', '  <meta name=\"msapplication-tap-highlight\" content=\"no\">', '  <meta http-equiv=\"Content-Security-Policy\" content=\"default-src * gap: data: blob: \\'unsafe-inline\\' \\'unsafe-eval\\' ws: wss:;\">'], // We are explicitly not using bundledJsCssUrlRewriteHook: in cordova we serve assets up directly from disk, so rewriting the URL does not make sense\n  _.map(css, function (_ref2) {                                                                                        // 28\n    var url = _ref2.url;                                                                                               // 28\n    return _.template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\">')({         // 28\n      href: url                                                                                                        // 30\n    });                                                                                                                // 29\n  }), ['  <script type=\"text/javascript\">', _.template('    __meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>));')({\n    conf: meteorRuntimeConfig                                                                                          // 36\n  }), '    if (/Android/i.test(navigator.userAgent)) {', // When Android app is emulated, it cannot connect to localhost,\n  // instead it should connect to 10.0.2.2                                                                             // 40\n  // (unless we\\'re using an http proxy; then it works!)                                                               // 41\n  '      if (!__meteor_runtime_config__.httpProxyPort) {', '        __meteor_runtime_config__.ROOT_URL = (__meteor_runtime_config__.ROOT_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');', '        __meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL = (__meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');', '      }', '    }', '  </script>', '', '  <script type=\"text/javascript\" src=\"/cordova.js\"></script>'], _.map(js, function (_ref3) {\n    var url = _ref3.url;                                                                                               // 51\n    return _.template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({                                 // 51\n      src: url                                                                                                         // 53\n    });                                                                                                                // 52\n  }), _.map(additionalStaticJs, function (_ref4) {                                                                     // 51\n    var contents = _ref4.contents,                                                                                     // 57\n        pathname = _ref4.pathname;                                                                                     // 57\n    return inlineScriptsAllowed ? _.template('  <script><%= contents %></script>')({                                   // 57\n      contents: contents                                                                                               // 60\n    }) : _.template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({                                   // 59\n      src: rootUrlPathPrefix + pathname                                                                                // 63\n    });                                                                                                                // 62\n  }), ['', head, '</head>', '', '<body>', body, '</body>', '</html>']).join('\\n');                                     // 57\n});                                                                                                                    // 78\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\"\n  ]\n});\nvar exports = require(\"./node_modules/meteor/boilerplate-generator/generator.js\");\n\n/* Exports */\nif (typeof Package === 'undefined') Package = {};\n(function (pkg, symbols) {\n  for (var s in symbols)\n    (s in pkg) || (pkg[s] = symbols[s]);\n})(Package['boilerplate-generator'] = exports, {\n  Boilerplate: Boilerplate\n});\n\n})();\n","servePath":"/packages/boilerplate-generator.js","sourceMap":{"version":3,"sources":["packages/boilerplate-generator/generator.js","packages/boilerplate-generator/template-web.browser.js","packages/boilerplate-generator/template-web.cordova.js"],"names":["module","export","Boilerplate","readFile","watch","require","v","WebBrowserTemplate","WebCordovaTemplate","readUtf8FileSync","Meteor","wrapAsync","filename","arch","manifest","options","template","_getTemplate","baseData","_generateBoilerplateFromManifest","toHTML","extraData","Error","urlMapper","_","identity","pathMapper","baseDataExtension","inline","boilerplateBaseData","css","js","head","body","meteorManifest","JSON","stringify","each","urlPath","item","url","itemObj","scriptContent","path","type","where","push","startsWith","exportDefault","meteorRuntimeConfig","rootUrlPathPrefix","inlineScriptsAllowed","additionalStaticJs","htmlAttributes","bundledJsCssUrlRewriteHook","dynamicHead","dynamicBody","concat","map","value","key","attrName","attrValue","join","href","conf","src","contents","pathname"],"mappings":"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","file":"/packages/boilerplate-generator.js","sourcesContent":["import { readFile } from 'fs';\n\nimport WebBrowserTemplate from './template-web.browser';\nimport WebCordovaTemplate from './template-web.cordova';\n\n// Copied from webapp_server\nconst readUtf8FileSync = filename => Meteor.wrapAsync(readFile)(filename, 'utf8');\n\nexport class Boilerplate {\n  constructor(arch, manifest, options = {}) {\n    this.template = _getTemplate(arch);\n    this.baseData = null;\n\n    this._generateBoilerplateFromManifest(\n      manifest,\n      options\n    );\n  }\n\n  // The 'extraData' argument can be used to extend 'self.baseData'. Its\n  // purpose is to allow you to specify data that you might not know at\n  // the time that you construct the Boilerplate object. (e.g. it is used\n  // by 'webapp' to specify data that is only known at request-time).\n  toHTML(extraData) {\n    if (!this.baseData || !this.template) {\n      throw new Error('Boilerplate did not instantiate correctly.');\n    }\n\n    return  \"<!DOCTYPE html>\\n\" +\n      this.template({ ...this.baseData, ...extraData });\n  }\n\n  // XXX Exported to allow client-side only changes to rebuild the boilerplate\n  // without requiring a full server restart.\n  // Produces an HTML string with given manifest and boilerplateSource.\n  // Optionally takes urlMapper in case urls from manifest need to be prefixed\n  // or rewritten.\n  // Optionally takes pathMapper for resolving relative file system paths.\n  // Optionally allows to override fields of the data context.\n  _generateBoilerplateFromManifest(manifest, {\n    urlMapper = _.identity,\n    pathMapper = _.identity,\n    baseDataExtension,\n    inline,\n  } = {}) {\n\n    const boilerplateBaseData = {\n      css: [],\n      js: [],\n      head: '',\n      body: '',\n      meteorManifest: JSON.stringify(manifest),\n      ...baseDataExtension,\n    };\n\n    _.each(manifest, item => {\n      const urlPath = urlMapper(item.url);\n      const itemObj = { url: urlPath };\n\n      if (inline) {\n        itemObj.scriptContent = readUtf8FileSync(\n          pathMapper(item.path));\n        itemObj.inline = true;\n      }\n\n      if (item.type === 'css' && item.where === 'client') {\n        boilerplateBaseData.css.push(itemObj);\n      }\n\n      if (item.type === 'js' && item.where === 'client' &&\n        // Dynamic JS modules should not be loaded eagerly in the\n        // initial HTML of the app.\n        !item.path.startsWith('dynamic/')) {\n        boilerplateBaseData.js.push(itemObj);\n      }\n\n      if (item.type === 'head') {\n        boilerplateBaseData.head =\n          readUtf8FileSync(pathMapper(item.path));\n      }\n\n      if (item.type === 'body') {\n        boilerplateBaseData.body =\n          readUtf8FileSync(pathMapper(item.path));\n      }\n    });\n\n    this.baseData = boilerplateBaseData;\n  }\n};\n\n// Returns a template function that, when called, produces the boilerplate\n// html as a string.\nconst _getTemplate = arch => {\n  if (arch === 'web.browser') {\n    return WebBrowserTemplate;\n  } else if (arch === 'web.cordova') {\n    return WebCordovaTemplate;\n  } else {\n    throw new Error('Unsupported arch: ' + arch);\n  }\n};\n","// Template function for rendering the boilerplate html for browsers\n\nexport default function({\n  meteorRuntimeConfig,\n  rootUrlPathPrefix,\n  inlineScriptsAllowed,\n  css,\n  js,\n  additionalStaticJs,\n  htmlAttributes,\n  bundledJsCssUrlRewriteHook,\n  head,\n  body,\n  dynamicHead,\n  dynamicBody,\n}) {\n  return [].concat(\n    [\n      '<html' +_.map(htmlAttributes, (value, key) =>\n        _.template(' <%= attrName %>=\"<%- attrValue %>\"')({\n          attrName: key,\n          attrValue: value\n        })\n      ).join('') + '>',\n      '<head>'\n    ],\n\n    _.map(css, ({url}) =>\n      _.template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\">')({\n        href: bundledJsCssUrlRewriteHook(url)\n      })\n    ),\n\n    [\n      head,\n      dynamicHead,\n      '</head>',\n      '<body>',\n      body,\n      dynamicBody,\n      '',\n      (inlineScriptsAllowed\n        ? _.template('  <script type=\"text/javascript\">__meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>))</script>')({\n          conf: meteorRuntimeConfig\n        })\n        : _.template('  <script type=\"text/javascript\" src=\"<%- src %>/meteor_runtime_config.js\"></script>')({\n          src: rootUrlPathPrefix\n        })\n      ) ,\n      ''\n    ],\n\n    _.map(js, ({url}) =>\n      _.template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n        src: bundledJsCssUrlRewriteHook(url)\n      })\n    ),\n\n    _.map(additionalStaticJs, ({contents, pathname}) => (\n      (inlineScriptsAllowed\n        ? _.template('  <script><%= contents %></script>')({\n          contents: contents\n        })\n        : _.template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n          src: rootUrlPathPrefix + pathname\n        }))\n    )),\n\n    [\n      '', '',\n      '</body>',\n      '</html>'\n    ],\n  ).join('\\n');\n}\n\n","// Template function for rendering the boilerplate html for cordova\n\nexport default function({\n  meteorRuntimeConfig,\n  rootUrlPathPrefix,\n  inlineScriptsAllowed,\n  css,\n  js,\n  additionalStaticJs,\n  htmlAttributes,\n  bundledJsCssUrlRewriteHook,\n  head,\n  body,\n  dynamicHead,\n  dynamicBody,\n}) {\n  return [].concat(\n    [\n      '<html>',\n      '<head>',\n      '  <meta charset=\"utf-8\">',\n      '  <meta name=\"format-detection\" content=\"telephone=no\">',\n      '  <meta name=\"viewport\" content=\"user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height\">',\n      '  <meta name=\"msapplication-tap-highlight\" content=\"no\">',\n      '  <meta http-equiv=\"Content-Security-Policy\" content=\"default-src * gap: data: blob: \\'unsafe-inline\\' \\'unsafe-eval\\' ws: wss:;\">',\n    ],\n    // We are explicitly not using bundledJsCssUrlRewriteHook: in cordova we serve assets up directly from disk, so rewriting the URL does not make sense\n    _.map(css, ({url}) =>\n      _.template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\">')({\n        href: url\n      })\n    ),\n    [\n      '  <script type=\"text/javascript\">',\n      _.template('    __meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>));')({\n        conf: meteorRuntimeConfig\n      }),\n      '    if (/Android/i.test(navigator.userAgent)) {',\n      // When Android app is emulated, it cannot connect to localhost,\n      // instead it should connect to 10.0.2.2\n      // (unless we\\'re using an http proxy; then it works!)\n      '      if (!__meteor_runtime_config__.httpProxyPort) {',\n      '        __meteor_runtime_config__.ROOT_URL = (__meteor_runtime_config__.ROOT_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');',\n      '        __meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL = (__meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');',\n      '      }',\n      '    }',\n      '  </script>',\n      '',\n      '  <script type=\"text/javascript\" src=\"/cordova.js\"></script>'\n    ],\n    _.map(js, ({url}) =>\n      _.template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n        src: url\n      })\n    ),\n\n    _.map(additionalStaticJs, ({contents, pathname}) => (\n      (inlineScriptsAllowed\n        ? _.template('  <script><%= contents %></script>')({\n          contents: contents\n        })\n        : _.template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n          src: rootUrlPathPrefix + pathname\n        }))\n    )),\n\n    [\n      '',\n      head,\n      '</head>',\n      '',\n      '<body>',\n      body,\n      '</body>',\n      '</html>'\n    ],\n  ).join('\\n');\n}\n\n"]}}]
{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"../../api/images/images.js","imported":["Images"],"specifiers":[{"kind":"named","imported":"Images","local":"Images"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/startup/client/facebook.js","filenameRelative":"imports/startup/client/facebook.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/startup/client/facebook.js.map","sourceFileName":"imports/startup/client/facebook.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"facebook"},"ignored":false,"code":"var module1 = module;\nvar Images = void 0;\nmodule1.watch(require(\"../../api/images/images.js\"), {\n    Images: function (v) {\n        Images = v;\n    }\n}, 0);\n\n//function to setup the facebook API\nsetupFacebook = function (callback) {\n    Meteor.call('getFBAppId', function (err, result) {\n        //get the app id from server\n        if (err) {\n            console.log(\"error retreiving FB App ID\");\n            callback(err, null);\n        } else {\n            //Initialize the facebook SDK\n            FB.init({\n                appId: result,\n                status: true,\n                xfbml: true,\n                version: 'v2.9'\n            }, function (err, response) {\n                if (err) {\n                    console.log(err);\n                } else {\n                    console.log(response);\n                }\n            });\n            callback(null, 1);\n        }\n    });\n};\n\nextendToken = function (accessToken) {\n    var appId = void 0,\n        appSec = void 0;\n    Meteor.call('getFBAppId', function (err, response) {\n        appId = response;\n        Meteor.call('getFBSecret', function (err, response2) {\n            appSec = response2;\n            console.log(appId);\n            console.log(appSec);\n            console.log(accessToken);\n            $.get(\"https://graph.facebook.com/oauth/access_token\", {\n                grant_type: 'fb_exchange_token',\n                client_id: appId,\n                client_secret: appSec,\n                fb_exchange_token: accessToken\n            }, function (data) {\n                console.log(data);\n            });\n        });\n    });\n}; //function to post a message to facebook\n\n\npostTextFacebook = function (obj) {\n    //console.log(\"attempting to log in\");\n    /*FB.api('/1152573311514394/feed', 'post', {access_token: 'EAAGTzYuTCloBAFMDsZBc4ZB8Vle8L7Scrm07kYvDRc0SvaOYLwbOCQBtinhUQ4OSlRQOdNY7qgIGBDrVK60ckPdcNHZC6mZC8rANyjZCtH4XcE5qexIZCSHFDniuMyGBAcm3eZCpRDmhZA3NrNUyKa63ymrX7kQ4UKA4ThYD7CJffivm32CPIJ7i5sPcQ9X7KTGk5PgGXXpwiQZDZD',\r\n         message: obj.headline + '\\n' + obj.content},\r\n         function (response) {\r\n             console.log(response);\r\n    });*/FB.login(function (response) {\n        //use this to get access token for user\n        //var token = response.authResponse.accessToken;\n        var pageToken, pageId;\n        console.log(response); //make the API call to access pages\n\n        FB.api('/me/accounts', function (response) {\n            //console.log(response);\n            //store the pageToken and pageId for the first entry.\n            //This account is intended to only have one page as admin\n            pageToken = response.data[0].access_token;\n            pageId = response.data[0].id; //extendToken(pageToken);\n            //make the API call to post as page\n\n            FB.api('/' + pageId + '/feed', 'post', {\n                access_token: pageToken,\n                message: obj.headline + '\\n' + obj.content\n            }, function (response) {\n                console.log(response);\n            });\n        });\n    }, {\n        scope: 'publish_actions,manage_pages,publish_pages'\n    }); //permissions listed here\n}; //test function to post with an image\n\n\npostImageFacebook = function (obj) {\n    console.log(\"posting to facebook\"); /*FB.api('/1152573311514394/feed', 'post', {access_token: 'EAAGTzYuTCloBAFMDsZBc4ZB8Vle8L7Scrm07kYvDRc0SvaOYLwbOCQBtinhUQ4OSlRQOdNY7qgIGBDrVK60ckPdcNHZC6mZC8rANyjZCtH4XcE5qexIZCSHFDniuMyGBAcm3eZCpRDmhZA3NrNUyKa63ymrX7kQ4UKA4ThYD7CJffivm32CPIJ7i5sPcQ9X7KTGk5PgGXXpwiQZDZD',\r\n                                            message: obj.headline,\r\n                                            picture: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg',\r\n                                            link: 'https://www.nytimes.com/2017/09/08/us/hurricane-irma-miami-florida.html?hp&action=click&pgtype=Homepage&clickSource=story-heading&module=span-ab-top-region&region=top-news&WT.nav=top-news'},  //'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'Images.findOne({'_id':obj.imgId}).url()\r\n                                            function (response) {\r\n                                                console.log(response);\r\n                                          });*/\n    FB.login(function (response) {\n        //use this to get access token for user\n        //var token = response.authResponse.accessToken;\n        var pageToken, pageId; //make the API call to access pages\n\n        FB.api('/me/accounts', function (response) {\n            console.log(response); //store the pageToken and pageId for the first entry.\n            //This account is intended to only have one page as admin\n\n            pageToken = response.data[0].access_token;\n            pageId = response.data[0].id; //make the API call to post as page\n\n            FB.api('/' + pageId + '/photos', 'post', {\n                access_token: pageToken,\n                message: obj.headline,\n                picture: Images.findOne({\n                    '_id': obj.imgId\n                }).url() //'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'\n                //link: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'\n                //url: 'https://ak.picdn.net/assets/cms/97e1dd3f8a3ecb81356fe754a1a113f31b6dbfd4-stock-photo-photo-of-a-common-kingfisher-alcedo-atthis-adult-male-perched-on-a-lichen-covered-branch-107647640.jpg'\n\n            }, function (response) {\n                console.log(response);\n            });\n        });\n    }, {\n        scope: 'publish_actions,manage_pages,publish_pages'\n    }); //permissions listed here\n}; //test function to post with an image\n\n\npostTextImageFacebook = function (obj) {\n    /*FB.api('/1152573311514394/feed', 'post', {access_token: 'EAAGTzYuTCloBALbOyEn5bDSAOVexEfStqMoHHhgXdZAeaPtUZCDduZAOjEggM89N8CdpfslUkG0OVxVzZBva4gRwla4oiySttyqjpjP92ALvYGean0aG2QdooSmQGhil9fOuarbssvgrnBXy0B8lJL2nZBj9EH83oQEtrnVj7wcIW3LkV8uBS',\r\n        message: obj.headline + '\\n' + obj.content,\r\n        picture: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg',\r\n        link: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'},  //'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'Images.findOne({'_id':obj.imgId}).url()\r\n        function (response) {\r\n            console.log(response);\r\n    });*/FB.login(function (response) {\n        //use this to get access token for user\n        //var token = response.authResponse.accessToken;\n        var pageToken, pageId; //make the API call to access pages\n\n        FB.api('/me/accounts', function (response) {\n            console.log(response); //store the pageToken and pageId for the first entry.\n            //This account is intended to only have one page as admin\n\n            pageToken = response.data[0].access_token;\n            pageId = response.data[0].id; //make the API call to post as page\n\n            FB.api('/' + pageId + '/photos', 'post', {\n                access_token: pageToken,\n                message: obj.headline + '\\n' + obj.content,\n                picture: Images.findOne({\n                    '_id': obj.imgId\n                }).url() //link: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'\n                // url: 'https://ak.picdn.net/assets/cms/97e1dd3f8a3ecb81356fe754a1a113f31b6dbfd4-stock-photo-photo-of-a-common-kingfisher-alcedo-atthis-adult-male-perched-on-a-lichen-covered-branch-107647640.jpg'\n\n            }, function (response) {\n                console.log(response);\n            });\n        });\n    }, {\n        scope: 'publish_actions,manage_pages,publish_pages'\n    }); //permissions listed here\n};","map":{"version":3,"sources":["imports/startup/client/facebook.js"],"names":["module1","module","Images","watch","require","v","setupFacebook","callback","Meteor","call","err","result","console","log","FB","init","appId","status","xfbml","version","response","extendToken","accessToken","appSec","response2","$","get","grant_type","client_id","client_secret","fb_exchange_token","data","postTextFacebook","obj","login","pageToken","pageId","api","access_token","id","message","headline","content","scope","postImageFacebook","picture","findOne","imgId","url","postTextImageFacebook"],"mappings":"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","file":"imports/startup/client/facebook.js.map","sourcesContent":["import {Images} from '../../api/images/images.js';\r\n\r\n//function to setup the facebook API\r\nsetupFacebook = function (callback) {\r\n    Meteor.call('getFBAppId', function (err, result) { //get the app id from server\r\n        if (err) {\r\n            console.log(\"error retreiving FB App ID\");\r\n            callback(err, null);\r\n        } else {\r\n            //Initialize the facebook SDK\r\n\r\n            FB.init({\r\n                appId: result,\r\n                status: true,\r\n                xfbml: true,\r\n                version: 'v2.9'\r\n            }, function(err, response) {\r\n                if (err) {\r\n                    console.log(err);\r\n                } else {\r\n                    console.log(response);\r\n                }\r\n            });\r\n            callback(null,1);\r\n        }\r\n    });\r\n}\r\n\r\nextendToken = function(accessToken) {\r\n    let appId, appSec;\r\n    Meteor.call('getFBAppId', function(err, response) {\r\n        appId = response;\r\n        Meteor.call('getFBSecret', function(err, response2) {\r\n            appSec = response2;\r\n            console.log(appId);\r\n            console.log(appSec);\r\n            console.log(accessToken);\r\n            $.get(\"https://graph.facebook.com/oauth/access_token\", {\r\n                grant_type:'fb_exchange_token',\r\n                client_id:appId,\r\n                client_secret:appSec,\r\n                fb_exchange_token:accessToken },\r\n                function (data) {\r\n                    console.log(data);\r\n            })\r\n        })\r\n    });\r\n\r\n}\r\n\r\n//function to post a message to facebook\r\npostTextFacebook = function (obj) {\r\n    //console.log(\"attempting to log in\");\r\n    /*FB.api('/1152573311514394/feed', 'post', {access_token: 'EAAGTzYuTCloBAFMDsZBc4ZB8Vle8L7Scrm07kYvDRc0SvaOYLwbOCQBtinhUQ4OSlRQOdNY7qgIGBDrVK60ckPdcNHZC6mZC8rANyjZCtH4XcE5qexIZCSHFDniuMyGBAcm3eZCpRDmhZA3NrNUyKa63ymrX7kQ4UKA4ThYD7CJffivm32CPIJ7i5sPcQ9X7KTGk5PgGXXpwiQZDZD',\r\n         message: obj.headline + '\\n' + obj.content},\r\n         function (response) {\r\n             console.log(response);\r\n    });*/\r\n    FB.login(function (response) {\r\n        //use this to get access token for user\r\n        //var token = response.authResponse.accessToken;\r\n        var pageToken, pageId;\r\n        console.log(response)\r\n        //make the API call to access pages\r\n        FB.api('/me/accounts', function (response) {\r\n            //console.log(response);\r\n\r\n            //store the pageToken and pageId for the first entry.\r\n            //This account is intended to only have one page as admin\r\n            pageToken = response.data[0].access_token;\r\n            pageId = response.data[0].id;\r\n            //extendToken(pageToken);\r\n\r\n            //make the API call to post as page\r\n            FB.api('/' + pageId + '/feed', 'post', {access_token: pageToken, message: obj.headline + '\\n' + obj.content}, function (response) {\r\n                console.log(response);\r\n            });\r\n\r\n        });\r\n    }, {scope: 'publish_actions,manage_pages,publish_pages'});  //permissions listed here\r\n}\r\n\r\n//test function to post with an image\r\npostImageFacebook = function (obj) {\r\n    console.log(\"posting to facebook\");\r\n    /*FB.api('/1152573311514394/feed', 'post', {access_token: 'EAAGTzYuTCloBAFMDsZBc4ZB8Vle8L7Scrm07kYvDRc0SvaOYLwbOCQBtinhUQ4OSlRQOdNY7qgIGBDrVK60ckPdcNHZC6mZC8rANyjZCtH4XcE5qexIZCSHFDniuMyGBAcm3eZCpRDmhZA3NrNUyKa63ymrX7kQ4UKA4ThYD7CJffivm32CPIJ7i5sPcQ9X7KTGk5PgGXXpwiQZDZD',\r\n        message: obj.headline,\r\n        picture: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg',\r\n        link: 'https://www.nytimes.com/2017/09/08/us/hurricane-irma-miami-florida.html?hp&action=click&pgtype=Homepage&clickSource=story-heading&module=span-ab-top-region&region=top-news&WT.nav=top-news'},  //'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'Images.findOne({'_id':obj.imgId}).url()\r\n        function (response) {\r\n            console.log(response);\r\n\r\n    });*/\r\n    FB.login(function (response) {\r\n        //use this to get access token for user\r\n        //var token = response.authResponse.accessToken;\r\n        var pageToken, pageId;\r\n\r\n        //make the API call to access pages\r\n        FB.api('/me/accounts', function (response) {\r\n            console.log(response);\r\n\r\n            //store the pageToken and pageId for the first entry.\r\n            //This account is intended to only have one page as admin\r\n            pageToken = response.data[0].access_token;\r\n            pageId = response.data[0].id;\r\n\r\n            //make the API call to post as page\r\n            FB.api('/' + pageId + '/photos', 'post', {\r\n                access_token: pageToken,\r\n                message: obj.headline,\r\n                picture: Images.findOne({'_id':obj.imgId}).url(),  //'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'\r\n                //link: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'\r\n                //url: 'https://ak.picdn.net/assets/cms/97e1dd3f8a3ecb81356fe754a1a113f31b6dbfd4-stock-photo-photo-of-a-common-kingfisher-alcedo-atthis-adult-male-perched-on-a-lichen-covered-branch-107647640.jpg'\r\n            }, function (response) {\r\n                console.log(response);\r\n            });\r\n        });\r\n    }, {scope: 'publish_actions,manage_pages,publish_pages'});  //permissions listed here\r\n}\r\n\r\n//test function to post with an image\r\npostTextImageFacebook = function (obj) {\r\n    /*FB.api('/1152573311514394/feed', 'post', {access_token: 'EAAGTzYuTCloBALbOyEn5bDSAOVexEfStqMoHHhgXdZAeaPtUZCDduZAOjEggM89N8CdpfslUkG0OVxVzZBva4gRwla4oiySttyqjpjP92ALvYGean0aG2QdooSmQGhil9fOuarbssvgrnBXy0B8lJL2nZBj9EH83oQEtrnVj7wcIW3LkV8uBS',\r\n        message: obj.headline + '\\n' + obj.content,\r\n        picture: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg',\r\n        link: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'},  //'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'Images.findOne({'_id':obj.imgId}).url()\r\n        function (response) {\r\n            console.log(response);\r\n    });*/\r\n    FB.login(function (response) {\r\n        //use this to get access token for user\r\n        //var token = response.authResponse.accessToken;\r\n        var pageToken, pageId;\r\n\r\n        //make the API call to access pages\r\n        FB.api('/me/accounts', function (response) {\r\n            console.log(response);\r\n\r\n            //store the pageToken and pageId for the first entry.\r\n            //This account is intended to only have one page as admin\r\n            pageToken = response.data[0].access_token;\r\n            pageId = response.data[0].id;\r\n\r\n            //make the API call to post as page\r\n            FB.api('/' + pageId + '/photos', 'post', {\r\n                access_token: pageToken,\r\n                message: obj.headline + '\\n' + obj.content,\r\n                picture: Images.findOne({'_id':obj.imgId}).url(),\r\n                //link: 'http://www.somebodymarketing.com/wp-content/uploads/2013/05/Stock-Dock-House.jpg'\r\n               // url: 'https://ak.picdn.net/assets/cms/97e1dd3f8a3ecb81356fe754a1a113f31b6dbfd4-stock-photo-photo-of-a-common-kingfisher-alcedo-atthis-adult-male-perched-on-a-lichen-covered-branch-107647640.jpg'\r\n            }, function (response) {\r\n                console.log(response);\r\n            });\r\n        });\r\n    }, {scope: 'publish_actions,manage_pages,publish_pages'});  //permissions listed here\r\n}\r\n"]},"hash":"9214a0519ab005d80e2ead474d3c414965e1ba12"}

{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"mailchimp-api-v3","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Mailchimp"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/startup/server/mailchimp.js","filenameRelative":"imports/startup/server/mailchimp.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/startup/server/mailchimp.js.map","sourceFileName":"imports/startup/server/mailchimp.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"mailchimp"},"ignored":false,"code":"var Mailchimp = void 0;\nmodule.watch(require(\"mailchimp-api-v3\"), {\n   \"default\": function (v) {\n      Mailchimp = v;\n   }\n}, 0);\n//const Mailchimp = require('mailchimp-api-v3')\nvar mailchimp = new Mailchimp('c63e149751b5b34657fc48286f336650-us16');\nMeteor.methods({\n   'getSubscribers': function () {\n      mailchimp.get('/lists/b7d23cbf79', function (results) {\n         return results;\n      });\n   },\n   'news.addSubscriber': function (email, fname, lname) {\n      mailchimp.post('/lists/b7d23cbf79/members', {\n         email_address: email,\n         status: 'subscribed',\n         merge_fields: {\n            FNAME: fname,\n            LNAME: lname\n         }\n      }, function (err, response) {\n         if (err) {\n            console.log(err);\n         } else {\n            console.log(JSON.stringify(response, null, 2));\n         }\n\n         return response;\n      });\n   },\n   'getTemplates': function () {\n      mailchimp.get('/templates', function (err, response) {\n         if (err) {\n            console.log(err);\n         } else {\n            console.log(JSON.stringify(response, null, 2));\n         }\n      });\n   },\n   'createCampaign': function (subjectLine, title) {\n      mailchimp.post('/campaigns', {\n         type: 'regular',\n         recipients: {\n            list_id: 'b7d23cbf79'\n         },\n         settings: {\n            subject_line: subjectLine,\n            title: title,\n            from_name: 'UHS Life Bulletin',\n            reply_to: 'hello@uhs.life',\n            template_id: 60467\n         }\n      }, function (err, response) {\n         if (err) {\n            console.log(err);\n         } else {\n            console.log(JSON.stringify(response, null, 2));\n            var campaignID = response.id;\n            mailchimp.put('/campaigns/' + campaignID + '/content', {\n               template: {\n                  id: 60467,\n                  sections: {\n                     \"image\": \"<img src='https://www.sitebuilderreport.com/assets/facebook-stock-up-446fff24fb11820517c520c4a5a4c032.jpg'>\",\n                     \"text\": \"<p>Changed text 2</p>\"\n                  }\n               }\n            }, function (err, response) {\n               if (err) {\n                  console.log(err);\n               } else {\n                  //console.log(JSON.stringify(response, null, 2));\n                  mailchimp.post('/campaigns/' + campaignID + '/actions/send', function (err, response) {\n                     if (err) {\n                        console.log(err);\n                     } else {\n                        console.log(JSON.stringify(response, null, 2));\n                     }\n                  });\n               }\n            });\n         }\n      });\n   }\n});","map":{"version":3,"sources":["imports/startup/server/mailchimp.js"],"names":["Mailchimp","module","watch","require","v","mailchimp","Meteor","methods","get","results","email","fname","lname","post","email_address","status","merge_fields","FNAME","LNAME","err","response","console","log","JSON","stringify","subjectLine","title","type","recipients","list_id","settings","subject_line","from_name","reply_to","template_id","campaignID","id","put","template","sections"],"mappings":"AAAA,IAAIA,kBAAJ;AAAcC,OAAOC,KAAP,CAAaC,QAAQ,kBAAR,CAAb,EAAyC;AAAA,wBAASC,CAAT,EAAW;AAACJ,kBAAUI,CAAV;AAAY;AAAxB,CAAzC,EAAmE,CAAnE;AAEd;AAEA,IAAMC,YAAY,IAAIL,SAAJ,CAAc,uCAAd,CAAlB;AAEAM,OAAOC,OAAP,CAAe;AACZ,qBAAmB,YAAW;AAC3BF,gBAAUG,GAAV,CAAc,mBAAd,EAAmC,UAASC,OAAT,EAAkB;AAClD,gBAAOA,OAAP;AACF,OAFD;AAGF,IALW;AAMZ,yBAAuB,UAASC,KAAT,EAAgBC,KAAhB,EAAuBC,KAAvB,EAA8B;AAClDP,gBAAUQ,IAAV,CAAe,2BAAf,EAA4C;AAACC,wBAAgBJ,KAAjB;AAAwBK,iBAAQ,YAAhC;AAA8CC,uBAAe;AAACC,mBAAQN,KAAT;AAAgBO,mBAAQN;AAAxB;AAA7D,OAA5C,EAA0I,UAAUO,GAAV,EAAeC,QAAf,EAAyB;AAChK,aAAID,GAAJ,EAAS;AACNE,oBAAQC,GAAR,CAAYH,GAAZ;AACF,UAFD,MAEO;AACJE,oBAAQC,GAAR,CAAYC,KAAKC,SAAL,CAAeJ,QAAf,EAAyB,IAAzB,EAA+B,CAA/B,CAAZ;AACF;;AACD,gBAAOA,QAAP;AACF,OAPD;AAQF,IAfW;AAgBZ,mBAAiB,YAAY;AAC1Bf,gBAAUG,GAAV,CAAc,YAAd,EAA4B,UAASW,GAAT,EAAcC,QAAd,EAAwB;AACjD,aAAID,GAAJ,EAAS;AACNE,oBAAQC,GAAR,CAAYH,GAAZ;AACF,UAFD,MAEO;AACJE,oBAAQC,GAAR,CAAYC,KAAKC,SAAL,CAAeJ,QAAf,EAAyB,IAAzB,EAA+B,CAA/B,CAAZ;AACF;AACH,OAND;AAOF,IAxBW;AAyBZ,qBAAmB,UAASK,WAAT,EAAsBC,KAAtB,EAA6B;AAC7CrB,gBAAUQ,IAAV,CAAe,YAAf,EACA;AACGc,eAAO,SADV;AAEGC,qBAAa;AACVC,qBAAS;AADC,UAFhB;AAKGC,mBAAW;AACRC,0BAAeN,WADP;AAERC,mBAAOA,KAFC;AAGRM,uBAAY,mBAHJ;AAIRC,sBAAW,gBAJH;AAKRC,yBAAc;AALN;AALd,OADA,EAaG,UAAUf,GAAV,EAAeC,QAAf,EAAyB;AACzB,aAAID,GAAJ,EAAS;AACNE,oBAAQC,GAAR,CAAYH,GAAZ;AACF,UAFD,MAEO;AACJE,oBAAQC,GAAR,CAAYC,KAAKC,SAAL,CAAeJ,QAAf,EAAyB,IAAzB,EAA+B,CAA/B,CAAZ;AACA,gBAAIe,aAAaf,SAASgB,EAA1B;AACA/B,sBAAUgC,GAAV,CAAc,gBAAcF,UAAd,GAAyB,UAAvC,EACA;AACGG,yBAAW;AACRF,sBAAK,KADG;AAERG,4BAAW;AACR,8BAAU,6GADF;AAER,6BAAS;AAFD;AAFH;AADd,aADA,EASG,UAASpB,GAAT,EAAcC,QAAd,EAAwB;AACxB,mBAAID,GAAJ,EAAS;AACNE,0BAAQC,GAAR,CAAYH,GAAZ;AACF,gBAFD,MAEO;AACJ;AACAd,4BAAUQ,IAAV,CAAe,gBAAcsB,UAAd,GAAyB,eAAxC,EAAyD,UAAShB,GAAT,EAAcC,QAAd,EAAwB;AAC9E,yBAAID,GAAJ,EAAS;AACNE,gCAAQC,GAAR,CAAYH,GAAZ;AACF,sBAFD,MAEO;AACJE,gCAAQC,GAAR,CAAYC,KAAKC,SAAL,CAAeJ,QAAf,EAAyB,IAAzB,EAA+B,CAA/B,CAAZ;AACF;AACH,mBAND;AAOF;AACH,aAtBD;AAuBF;AACH,OA3CD;AA4CF;AAtEW,CAAf","file":"imports/startup/server/mailchimp.js.map","sourcesContent":["import Mailchimp from 'mailchimp-api-v3';\r\n\r\n//const Mailchimp = require('mailchimp-api-v3')\r\n\r\nconst mailchimp = new Mailchimp('c63e149751b5b34657fc48286f336650-us16');\r\n\r\nMeteor.methods({\r\n   'getSubscribers' : function() {\r\n      mailchimp.get('/lists/b7d23cbf79', function(results) {\r\n         return results;\r\n      })\r\n   },\r\n   'news.addSubscriber' : function(email, fname, lname) {\r\n      mailchimp.post('/lists/b7d23cbf79/members', {email_address : email, status: 'subscribed', merge_fields : {FNAME : fname, LNAME : lname}}, function (err, response) {\r\n         if (err) {\r\n            console.log(err)\r\n         } else {\r\n            console.log(JSON.stringify(response, null, 2));\r\n         }\r\n         return response;\r\n      })\r\n   },\r\n   'getTemplates' : function () {\r\n      mailchimp.get('/templates', function(err, response) {\r\n         if (err) {\r\n            console.log(err);\r\n         } else {\r\n            console.log(JSON.stringify(response, null, 2));\r\n         }\r\n      })\r\n   },\r\n   'createCampaign' : function(subjectLine, title) {\r\n      mailchimp.post('/campaigns',\r\n      {\r\n         type : 'regular',\r\n         recipients : {\r\n            list_id: 'b7d23cbf79'\r\n         },\r\n         settings : {\r\n            subject_line : subjectLine,\r\n            title: title,\r\n            from_name : 'UHS Life Bulletin',\r\n            reply_to : 'hello@uhs.life',\r\n            template_id : 60467\r\n         }\r\n      }, function (err, response) {\r\n         if (err) {\r\n            console.log(err);\r\n         } else {\r\n            console.log(JSON.stringify(response, null, 2));\r\n            let campaignID = response.id;\r\n            mailchimp.put('/campaigns/'+campaignID+'/content',\r\n            {\r\n               template : {\r\n                  id : 60467,\r\n                  sections : {\r\n                     \"image\" : \"<img src='https://www.sitebuilderreport.com/assets/facebook-stock-up-446fff24fb11820517c520c4a5a4c032.jpg'>\",\r\n                     \"text\" : \"<p>Changed text 2</p>\"\r\n                  }\r\n               }\r\n            }, function(err, response) {\r\n               if (err) {\r\n                  console.log(err);\r\n               } else {\r\n                  //console.log(JSON.stringify(response, null, 2));\r\n                  mailchimp.post('/campaigns/'+campaignID+'/actions/send', function(err, response) {\r\n                     if (err) {\r\n                        console.log(err);\r\n                     } else {\r\n                        console.log(JSON.stringify(response, null, 2));\r\n                     }\r\n                  })\r\n               }\r\n            })\r\n         }\r\n      })\r\n   }\r\n})\r\n"]},"hash":"3ec57eb040f3ca1ac7de5837193c551f08894c37"}

{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/startup/server/facebook.js","filenameRelative":"imports/startup/server/facebook.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/startup/server/facebook.js.map","sourceFileName":"imports/startup/server/facebook.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"facebook"},"ignored":false,"code":"var Meteor = void 0;\nmodule.watch(require(\"meteor/meteor\"), {\n    Meteor: function (v) {\n        Meteor = v;\n    }\n}, 0);\nMeteor.methods({\n    //return the facebook app id\n    'getFBAppId': function () {\n        if (!(Roles.userIsInRole(this.userId, 'teacher') || Roles.userIsInRole(this.userId, 'admin') || Roles.userIsInRole(this.userId, 'announcementEditor'))) {\n            throw new Meteor.Error(400, \"You do not have permission...Reported\");\n        }\n\n        return '443985995958874';\n    },\n    'getFBSecret': function () {\n        if (!(Roles.userIsInRole(this.userId, 'teacher') || Roles.userIsInRole(this.userId, 'admin') || Roles.userIsInRole(this.userId, 'announcementEditor'))) {\n            throw new Meteor.Error(400, \"You do not have permission...Reported\");\n        }\n\n        return '8d9cbbb60eb7f71e105f23ca026f391c';\n    },\n    'extendToken': function (accessToken) {\n        /*$.get(\"https://graph.facebook.com/oauth/access_token?\", {\r\n        grant_type:'fb_exchange_token',\r\n        client_id:appId,\r\n        client_secret:appSec,\r\n        fb_exchange_token:accessToken },\r\n        function (data) {\r\n        console.log(data);\r\n        })*/if (!(Roles.userIsInRole(this.userId, 'teacher') || Roles.userIsInRole(this.userId, 'admin') || Roles.userIsInRole(this.userId, 'announcementEditor'))) {\n            throw new Meteor.Error(400, \"You do not have permission...Reported\");\n        }\n\n        Meteor.call('getFBAppId', function (err, response) {\n            var appId = response;\n            Meteor.call('getFBSecret', function (err, response2) {\n                var appSec = response2;\n                console.log(\"proceeding to HTTP call\");\n                HTTP.call('GET', \"https://graph.facebook.com/oauth/access_token?\", {\n                    grant_type: 'fb_exchange_token',\n                    client_id: appId,\n                    client_secret: appSec,\n                    fb_exchange_token: accessToken\n                }, function (err, data) {\n                    if (err) {\n                        console.log(err);\n                    } else {\n                        console.log(\"HELLO\");\n                        console.log(data);\n                    }\n                });\n            });\n        });\n    }\n});","map":{"version":3,"sources":["imports/startup/server/facebook.js"],"names":["Meteor","module","watch","require","v","methods","Roles","userIsInRole","userId","Error","accessToken","call","err","response","appId","response2","appSec","console","log","HTTP","grant_type","client_id","client_secret","fb_exchange_token","data"],"mappings":"AAAA,IAAIA,eAAJ;AAAWC,OAAOC,KAAP,CAAaC,QAAQ,eAAR,CAAb,EAAsC;AAACH,UAAD,YAAQI,CAAR,EAAU;AAACJ,iBAAOI,CAAP;AAAS;AAApB,CAAtC,EAA4D,CAA5D;AAEXJ,OAAOK,OAAP,CAAe;AACX;AACA,kBAAe,YAAW;AACtB,YAAI,EAAEC,MAAMC,YAAN,CAAoB,KAAKC,MAAzB,EAAiC,SAAjC,KACNF,MAAMC,YAAN,CAAoB,KAAKC,MAAzB,EAAiC,OAAjC,CADM,IAENF,MAAMC,YAAN,CAAoB,KAAKC,MAAzB,EAAiC,oBAAjC,CAFI,CAAJ,EAEyD;AACrD,kBAAM,IAAIR,OAAOS,KAAX,CAAiB,GAAjB,EAAsB,uCAAtB,CAAN;AACH;;AACD,eAAO,iBAAP;AACH,KATU;AAUX,mBAAgB,YAAW;AACvB,YAAI,EAAEH,MAAMC,YAAN,CAAoB,KAAKC,MAAzB,EAAiC,SAAjC,KACNF,MAAMC,YAAN,CAAoB,KAAKC,MAAzB,EAAiC,OAAjC,CADM,IAENF,MAAMC,YAAN,CAAoB,KAAKC,MAAzB,EAAiC,oBAAjC,CAFI,CAAJ,EAEyD;AACrD,kBAAM,IAAIR,OAAOS,KAAX,CAAiB,GAAjB,EAAsB,uCAAtB,CAAN;AACH;;AACD,eAAO,kCAAP;AACH,KAjBU;AAkBX,mBAAgB,UAASC,WAAT,EAAsB;AAClC;;;;;;;YAQA,IAAI,EAAEJ,MAAMC,YAAN,CAAoB,KAAKC,MAAzB,EAAiC,SAAjC,KACNF,MAAMC,YAAN,CAAoB,KAAKC,MAAzB,EAAiC,OAAjC,CADM,IAENF,MAAMC,YAAN,CAAoB,KAAKC,MAAzB,EAAiC,oBAAjC,CAFI,CAAJ,EAEyD;AACrD,kBAAM,IAAIR,OAAOS,KAAX,CAAiB,GAAjB,EAAsB,uCAAtB,CAAN;AACH;;AAEDT,eAAOW,IAAP,CAAY,YAAZ,EAA0B,UAASC,GAAT,EAAcC,QAAd,EAAwB;AAC9C,gBAAIC,QAAQD,QAAZ;AACAb,mBAAOW,IAAP,CAAY,aAAZ,EAA2B,UAASC,GAAT,EAAcG,SAAd,EAAyB;AAChD,oBAAIC,SAASD,SAAb;AACAE,wBAAQC,GAAR,CAAY,yBAAZ;AACAC,qBAAKR,IAAL,CAAW,KAAX,EAAkB,gDAAlB,EAAoE;AAChES,gCAAW,mBADqD;AAEhEC,+BAAUP,KAFsD;AAGhEQ,mCAAcN,MAHkD;AAIhEO,uCAAkBb;AAJ8C,iBAApE,EAKI,UAAUE,GAAV,EAAeY,IAAf,EAAqB;AACrB,wBAAIZ,GAAJ,EAAS;AACLK,gCAAQC,GAAR,CAAYN,GAAZ;AACH,qBAFD,MAEO;AACHK,gCAAQC,GAAR,CAAY,OAAZ;AACAD,gCAAQC,GAAR,CAAYM,IAAZ;AACH;AACJ,iBAZD;AAaH,aAhBD;AAiBH,SAnBD;AAoBH;AArDU,CAAf","file":"imports/startup/server/facebook.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\r\n\r\nMeteor.methods({\r\n    //return the facebook app id\r\n    'getFBAppId' : function() {\r\n        if (!(Roles.userIsInRole( this.userId, 'teacher') ||\r\n        Roles.userIsInRole( this.userId, 'admin') ||\r\n        Roles.userIsInRole( this.userId, 'announcementEditor'))) {\r\n            throw new Meteor.Error(400, \"You do not have permission...Reported\");\r\n        }\r\n        return '443985995958874';\r\n    },\r\n    'getFBSecret' : function() {\r\n        if (!(Roles.userIsInRole( this.userId, 'teacher') ||\r\n        Roles.userIsInRole( this.userId, 'admin') ||\r\n        Roles.userIsInRole( this.userId, 'announcementEditor'))) {\r\n            throw new Meteor.Error(400, \"You do not have permission...Reported\");\r\n        }\r\n        return '8d9cbbb60eb7f71e105f23ca026f391c';\r\n    },\r\n    'extendToken' : function(accessToken) {\r\n        /*$.get(\"https://graph.facebook.com/oauth/access_token?\", {\r\n        grant_type:'fb_exchange_token',\r\n        client_id:appId,\r\n        client_secret:appSec,\r\n        fb_exchange_token:accessToken },\r\n        function (data) {\r\n        console.log(data);\r\n    })*/\r\n        if (!(Roles.userIsInRole( this.userId, 'teacher') ||\r\n        Roles.userIsInRole( this.userId, 'admin') ||\r\n        Roles.userIsInRole( this.userId, 'announcementEditor'))) {\r\n            throw new Meteor.Error(400, \"You do not have permission...Reported\");\r\n        }\r\n\r\n        Meteor.call('getFBAppId', function(err, response) {\r\n            let appId = response;\r\n            Meteor.call('getFBSecret', function(err, response2) {\r\n                let appSec = response2;\r\n                console.log(\"proceeding to HTTP call\")\r\n                HTTP.call( 'GET', \"https://graph.facebook.com/oauth/access_token?\", {\r\n                    grant_type:'fb_exchange_token',\r\n                    client_id:appId,\r\n                    client_secret:appSec,\r\n                    fb_exchange_token:accessToken },\r\n                    function (err, data) {\r\n                    if (err) {\r\n                        console.log(err);\r\n                    } else {\r\n                        console.log(\"HELLO\");\r\n                        console.log(data);\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    }\r\n});\r\n"]},"hash":"33b3e00d6084d3dc7c9ae254a897c396da63a619"}

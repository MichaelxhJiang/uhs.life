{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"./drafts.js","imported":["Drafts"],"specifiers":[{"kind":"named","imported":"Drafts","local":"Drafts"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/api/drafts/draftMethods.js","filenameRelative":"imports/api/drafts/draftMethods.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/api/drafts/draftMethods.js.map","sourceFileName":"imports/api/drafts/draftMethods.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"draftMethods"},"ignored":false,"code":"var Meteor = void 0;\nmodule.watch(require(\"meteor/meteor\"), {\n    Meteor: function (v) {\n        Meteor = v;\n    }\n}, 0);\nvar Drafts = void 0;\nmodule.watch(require(\"./drafts.js\"), {\n    Drafts: function (v) {\n        Drafts = v;\n    }\n}, 1);\n\nif (Meteor.isServer) {\n    Meteor.publish('drafts', function () {\n        function draftsPublication(limit) {\n            return Drafts.find({\n                'author': this.userId\n            }, {\n                limit: limit\n            });\n        }\n\n        return draftsPublication;\n    }());\n}\n\nMeteor.methods({\n    'drafts.postDraftTextImage': function (json) {\n        if (!Roles.userIsInRole(this.userId, ['teacher', 'admin', 'announcementEditor'])) {\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\n        } //adds draft to the Drafts collection\n\n\n        Drafts.insert(json, function (err, content) {\n            //error catch for algolia issues\n            if (err) {\n                console.error(err);\n            }\n        });\n    },\n    'drafts.postDraftText': function (json) {\n        if (!Roles.userIsInRole(this.userId, ['teacher', 'admin', 'announcementEditor'])) {\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\n        } //adds draft to the Drafts collection\n\n\n        Drafts.insert(json, function (err, content) {\n            //error catch for algolia issues\n            if (err) {\n                console.error(err);\n            }\n        });\n    },\n    'drafts.postDraftImage': function (json) {\n        if (!Roles.userIsInRole(this.userId, ['teacher', 'admin', 'announcementEditor'])) {\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\n        } //adds draft to the Drafts collection\n\n\n        Drafts.insert(json, function (err, content) {\n            //error catch for algolia issues\n            if (err) {\n                console.error(err);\n            }\n        });\n    },\n    'drafts.postDraftBlog': function (json) {\n        if (!Roles.userIsInRole(this.userId, ['teacher', 'admin', 'announcementEditor'])) {\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\n        } //adds draft to the Drafts collection\n\n\n        Drafts.insert(json, function (err, content) {\n            //error catch for algolia issues\n            if (err) {\n                console.error(err);\n            }\n        });\n    },\n    'drafts.remove': function (id) {\n        if (!Roles.userIsInRole(this.userId, ['teacher', 'admin', 'announcementEditor'])) {\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\n        }\n\n        var draft = Drafts.findOne({\n            _id: id\n        });\n\n        if (draft.author !== this.userId) {\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\n        }\n\n        return Drafts.remove({\n            _id: id\n        });\n    }\n});","map":{"version":3,"sources":["imports/api/drafts/draftMethods.js"],"names":["Meteor","module","watch","require","v","Drafts","isServer","publish","draftsPublication","limit","find","userId","methods","json","Roles","userIsInRole","Error","insert","err","content","console","error","id","draft","findOne","_id","author","remove"],"mappings":"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","file":"imports/api/drafts/draftMethods.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\r\nimport { Drafts } from './drafts.js';\r\n\r\nif (Meteor.isServer) {\r\n   Meteor.publish('drafts', function draftsPublication(limit) {\r\n    return Drafts.find({\r\n        'author': this.userId\r\n    },{\r\n        limit: limit\r\n    });\r\n  });\r\n}\r\n\r\nMeteor.methods({\r\n    'drafts.postDraftTextImage' : function(json) {\r\n        if (!Roles.userIsInRole( this.userId, ['teacher', 'admin', 'announcementEditor'])) {\r\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\r\n        }\r\n\r\n        //adds draft to the Drafts collection\r\n        Drafts.insert(json, function(err, content) {\r\n            //error catch for algolia issues\r\n            if(err) {\r\n                console.error(err);\r\n            }\r\n        });\r\n    },\r\n    'drafts.postDraftText' : function(json) {\r\n        if (!Roles.userIsInRole( this.userId, ['teacher', 'admin', 'announcementEditor'])) {\r\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\r\n        }\r\n\r\n        //adds draft to the Drafts collection\r\n        Drafts.insert(json, function(err, content) {\r\n            //error catch for algolia issues\r\n            if(err) {\r\n                console.error(err);\r\n            }\r\n        });\r\n    },\r\n    'drafts.postDraftImage' : function(json) {\r\n        if (!Roles.userIsInRole( this.userId, ['teacher', 'admin', 'announcementEditor'])) {\r\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\r\n        }\r\n\r\n        //adds draft to the Drafts collection\r\n        Drafts.insert(json, function(err, content) {\r\n            //error catch for algolia issues\r\n            if(err) {\r\n                console.error(err);\r\n            }\r\n        });\r\n    },\r\n    'drafts.postDraftBlog' : function(json) {\r\n        if (!Roles.userIsInRole( this.userId, ['teacher', 'admin', 'announcementEditor'])) {\r\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\r\n        }\r\n\r\n        //adds draft to the Drafts collection\r\n        Drafts.insert(json, function(err, content) {\r\n            //error catch for algolia issues\r\n            if(err) {\r\n                console.error(err);\r\n            }\r\n        });\r\n    },\r\n    'drafts.remove' : function(id) {\r\n        if (!Roles.userIsInRole( this.userId, ['teacher', 'admin', 'announcementEditor'])) {\r\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\r\n        }\r\n        let draft = Drafts.findOne({_id: id});\r\n        if(draft.author !== this.userId){\r\n            throw new Meteor.Error(403, \"You do not have permission...Reported\");\r\n        }\r\n        return Drafts.remove({_id: id});\r\n   }\r\n});\r\n"]},"hash":"40a3cf533972a2eac5da5bcbd039db30a453fee7"}

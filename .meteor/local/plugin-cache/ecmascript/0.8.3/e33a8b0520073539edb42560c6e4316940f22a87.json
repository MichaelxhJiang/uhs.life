{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"./blogs.html","imported":[],"specifiers":[]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/ui/pages/blogs.js","filenameRelative":"imports/ui/pages/blogs.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/ui/pages/blogs.js.map","sourceFileName":"imports/ui/pages/blogs.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"blogs"},"ignored":false,"code":"module.watch(require(\"./blogs.html\"));\nTemplate.blogs.onCreated(function () {\n    Session.set('navTitle', 'Stories');\n});\nTemplate.blogs.onRendered(function () {\n    Tracker.autorun(function () {\n        Meteor.subscribe('blogCategories');\n        Meteor.subscribe('posts');\n    });\n});\nTemplate.blogs.helpers({\n    'blogCategories': function () {\n        return BlogCategories.find({});\n    }\n});\nTemplate.blogCategory.helpers({\n    'categoryName': function () {\n        return this.name;\n    },\n    'blogPreviews': function () {\n        console.log(this.name);\n        return Posts.find({\n            'type': 'blog',\n            'categories': this.name\n        }, {\n            limit: 4\n        });\n    }\n});\nTemplate.blogItem.onRendered(function () {});\nTemplate.blogItem.helpers({\n    'imageLink': function () {\n        if (this.unsplash) {\n            console.log(this);\n            return this.unsplash.urls.full;\n        } else if (this.imgId) {\n            try {\n                return Images.findOne({\n                    _id: this.imgId\n                }).url();\n            } catch (e) {//console.log('error getting photo')\n            }\n        }\n    },\n    'writer': function () {\n        return Meteor.users.findOne({\n            _id: this.author\n        }).services.google.name;\n    },\n    'date': function () {\n        return moment(this.releasedDate).format(\"MMMM Do YYYY\");\n    },\n    'subtitle': function () {\n        var string = this.subtitle;\n        var length = 40;\n        return string.length > length ? string.substring(0, length - 3) + \"...\" : string;\n    }\n});\nTemplate.blogItem.events({\n    'click .blog-item': function (evt, template) {\n        var obj = $(evt.target).closest($('.blog-item'));\n        var id = obj.attr('id');\n        FlowRouter.go('/blog/' + id);\n    }\n});","map":{"version":3,"sources":["imports/ui/pages/blogs.js"],"names":["module","watch","require","Template","blogs","onCreated","Session","set","onRendered","Tracker","autorun","Meteor","subscribe","helpers","BlogCategories","find","blogCategory","name","console","log","Posts","limit","blogItem","unsplash","urls","full","imgId","Images","findOne","_id","url","e","users","author","services","google","moment","releasedDate","format","string","subtitle","length","substring","events","evt","template","obj","$","target","closest","id","attr","FlowRouter","go"],"mappings":"AAAAA,OAAOC,KAAP,CAAaC,QAAQ,cAAR,CAAb;AAKAC,SAASC,KAAT,CAAeC,SAAf,CAAyB,YAAY;AACjCC,YAAQC,GAAR,CAAY,UAAZ,EAAwB,SAAxB;AACH,CAFD;AAIAJ,SAASC,KAAT,CAAeI,UAAf,CAA0B,YAAY;AAClCC,YAAQC,OAAR,CAAgB,YAAY;AACxBC,eAAOC,SAAP,CAAiB,gBAAjB;AACAD,eAAOC,SAAP,CAAiB,OAAjB;AACH,KAHD;AAIH,CALD;AAOAT,SAASC,KAAT,CAAeS,OAAf,CAAuB;AACnB,sBAAkB,YAAY;AAC1B,eAAOC,eAAeC,IAAf,CAAoB,EAApB,CAAP;AACH;AAHkB,CAAvB;AAMAZ,SAASa,YAAT,CAAsBH,OAAtB,CAA8B;AAC1B,oBAAgB,YAAY;AACxB,eAAO,KAAKI,IAAZ;AACH,KAHyB;AAI1B,oBAAgB,YAAY;AACxBC,gBAAQC,GAAR,CAAY,KAAKF,IAAjB;AACA,eAAOG,MAAML,IAAN,CAAW;AACd,oBAAQ,MADM;AAEd,0BAAc,KAAKE;AAFL,SAAX,EAGL;AACEI,mBAAO;AADT,SAHK,CAAP;AAMH;AAZyB,CAA9B;AAeAlB,SAASmB,QAAT,CAAkBd,UAAlB,CAA6B,YAAY,CACxC,CADD;AAGAL,SAASmB,QAAT,CAAkBT,OAAlB,CAA0B;AACtB,iBAAa,YAAY;AACrB,YAAG,KAAKU,QAAR,EAAiB;AACbL,oBAAQC,GAAR,CAAY,IAAZ;AACA,mBAAO,KAAKI,QAAL,CAAcC,IAAd,CAAmBC,IAA1B;AACH,SAHD,MAGM,IAAG,KAAKC,KAAR,EAAc;AAChB,gBAAG;AACC,uBAAOC,OAAOC,OAAP,CAAe;AAACC,yBAAK,KAAKH;AAAX,iBAAf,EAAkCI,GAAlC,EAAP;AACH,aAFD,CAEC,OAAMC,CAAN,EAAQ,CACL;AACH;AACJ;AACJ,KAZqB;AAatB,cAAU,YAAY;AAClB,eAAOpB,OAAOqB,KAAP,CAAaJ,OAAb,CAAqB;AAACC,iBAAK,KAAKI;AAAX,SAArB,EAAyCC,QAAzC,CAAkDC,MAAlD,CAAyDlB,IAAhE;AACH,KAfqB;AAgBtB,YAAQ,YAAY;AAChB,eAAOmB,OAAO,KAAKC,YAAZ,EAA0BC,MAA1B,CAAiC,cAAjC,CAAP;AACH,KAlBqB;AAmBtB,gBAAY,YAAY;AACpB,YAAIC,SAAS,KAAKC,QAAlB;AACA,YAAIC,SAAS,EAAb;AACA,eAAOF,OAAOE,MAAP,GAAgBA,MAAhB,GACHF,OAAOG,SAAP,CAAiB,CAAjB,EAAoBD,SAAS,CAA7B,IAAkC,KAD/B,GAEHF,MAFJ;AAGH;AAzBqB,CAA1B;AA4BApC,SAASmB,QAAT,CAAkBqB,MAAlB,CAAyB;AACrB,wBAAoB,UAAUC,GAAV,EAAcC,QAAd,EAAwB;AACxC,YAAIC,MAAMC,EAAEH,IAAII,MAAN,EAAcC,OAAd,CAAsBF,EAAE,YAAF,CAAtB,CAAV;AACA,YAAIG,KAAKJ,IAAIK,IAAJ,CAAS,IAAT,CAAT;AACAC,mBAAWC,EAAX,CAAc,WAASH,EAAvB;AACH;AALoB,CAAzB","file":"imports/ui/pages/blogs.js.map","sourcesContent":["/**\r\n * Created by Yonglin Wang on 9/12/2017.\r\n */\r\nimport './blogs.html'\r\n\r\nTemplate.blogs.onCreated(function () {\r\n    Session.set('navTitle', 'Stories');\r\n});\r\n\r\nTemplate.blogs.onRendered(function () {\r\n    Tracker.autorun(function () {\r\n        Meteor.subscribe('blogCategories');\r\n        Meteor.subscribe('posts')\r\n    })\r\n});\r\n\r\nTemplate.blogs.helpers({\r\n    'blogCategories': function () {\r\n        return BlogCategories.find({})\r\n    }\r\n});\r\n\r\nTemplate.blogCategory.helpers({\r\n    'categoryName': function () {\r\n        return this.name;\r\n    },\r\n    'blogPreviews': function () {\r\n        console.log(this.name);\r\n        return Posts.find({\r\n            'type': 'blog',\r\n            'categories': this.name\r\n        },{\r\n            limit: 4\r\n        });\r\n    }\r\n});\r\n\r\nTemplate.blogItem.onRendered(function () {\r\n});\r\n\r\nTemplate.blogItem.helpers({\r\n    'imageLink': function () {\r\n        if(this.unsplash){\r\n            console.log(this);\r\n            return this.unsplash.urls.full;\r\n        }else if(this.imgId){\r\n            try{\r\n                return Images.findOne({_id: this.imgId}).url();\r\n            }catch(e){\r\n                //console.log('error getting photo')\r\n            }\r\n        }\r\n    },\r\n    'writer': function () {\r\n        return Meteor.users.findOne({_id: this.author}).services.google.name;\r\n    },\r\n    'date': function () {\r\n        return moment(this.releasedDate).format(\"MMMM Do YYYY\");\r\n    },\r\n    'subtitle': function () {\r\n        let string = this.subtitle;\r\n        let length = 40;\r\n        return string.length > length ?\r\n            string.substring(0, length - 3) + \"...\" :\r\n            string;\r\n    }\r\n});\r\n\r\nTemplate.blogItem.events({\r\n    'click .blog-item': function (evt,template) {\r\n        let obj = $(evt.target).closest($('.blog-item'));\r\n        let id = obj.attr('id');\r\n        FlowRouter.go('/blog/'+id);\r\n    }\r\n})"]},"hash":"e33a8b0520073539edb42560c6e4316940f22a87"}
